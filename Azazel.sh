#!/bin/bash
echo -e "\e[31m   ___                          " ; 
sleep 0.2
echo "  -   -_,                     ,," ; 
sleep 0.2
echo " (  ~/||        _             ||" ; 
sleep 0.2
echo " (  / ||  /\\  < \, /\\  _-_  ||" ; 
sleep 0.2
echo "  \/==||   /   /-||  /  || \\ ||" ; 
sleep 0.2
echo "  /_ _||  /\\ (( || /\\ ||/   ||" ; 
sleep 0.2
echo " (  - \\,  ||  \/\\  || \\,/  \\" ; 
sleep 0.2
echo "          /         /          " ;
sleep 0.2
echo -e "         (,        (,         \e[37m "  ;
sleep 0.2
                                                                

sleep 1;
echo "                         created by yamotoz                                       ";
sleep 0.5;
echo "                          since 2024/03/08                                        ";
sleep 0.5;
echo  " ";
echo  " ";
echo  " ";
echo  " ";
echo  " ";        

                                                  
                                                  
                                                  
echo -e "\e[31m____________________¶¶__¶_5¶¶ ";
sleep 0.1;
echo "____________5¶5__¶5__¶¶_5¶__¶¶¶5 ";
sleep 0.1;
echo "__________5¶¶¶__¶¶5¶¶¶¶¶5¶¶__5¶¶¶5 ";
sleep 0.1;
echo "_________¶¶¶¶__¶5¶¶¶¶¶¶¶¶¶¶¶__5¶¶¶¶5 ";
sleep 0.1;
echo "_______5¶¶¶¶__¶¶¶¶¶¶¶¶¶¶¶_5¶¶__5¶¶¶¶¶5 ";
sleep 0.1;
echo "______¶¶¶¶¶5_¶¶¶¶¶¶¶¶¶¶¶¶¶5¶¶¶__¶¶¶¶5¶5 ";
sleep 0.1;
echo "_____¶¶¶¶¶¶_¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶_¶¶¶¶¶¶¶5 ";
sleep 0.1;
echo "____¶¶¶¶¶¶¶_¶¶¶5¶¶¶¶5_¶¶¶¶¶5_5¶_¶¶¶¶¶¶¶¶5 ";
sleep 0.1;
echo "___¶¶¶¶¶¶¶¶__5¶¶¶¶¶¶5___5¶¶¶¶__5¶¶¶¶¶¶¶¶¶5 ";
sleep 0.1;
echo "__¶¶¶¶¶¶¶¶¶¶5__5¶¶¶¶¶¶5__5¶¶5_5¶¶¶¶¶¶¶¶¶¶¶ ";
sleep 0.1;
echo "_5¶¶¶¶¶¶¶¶¶¶¶¶_5¶¶¶¶¶¶¶¶¶5__5¶¶¶¶¶¶¶¶¶¶¶¶¶5 ";
sleep 0.1;
echo "_¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶_5¶¶¶¶ ";
sleep 0.1;
echo "5¶¶¶¶¶¶¶¶¶¶¶¶5___5¶¶¶¶¶¶¶5__¶¶¶¶5_¶¶¶5_¶¶¶¶ ";
sleep 0.1;
echo "¶¶¶¶¶¶¶¶_¶¶5_5¶5__¶¶¶¶¶¶¶¶¶5_5¶¶¶_5¶¶¶_5¶¶¶5 ";
sleep 0.1;
echo "¶5¶¶¶¶¶5_¶¶_5¶¶¶¶¶_¶¶¶¶¶¶¶¶¶¶5_5¶¶_5¶¶¶_¶¶¶5 ";
sleep 0.1;
echo "¶¶¶¶_¶¶__¶__¶¶¶¶¶¶5_5¶¶¶¶¶¶¶¶¶¶5_¶¶_5¶¶_5¶¶¶ ";
sleep 0.1;
echo "¶¶¶5_5¶______5¶¶5¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶5_¶¶_5¶5_¶5¶ ";
sleep 0.1;
echo "5¶¶____5¶¶¶¶5_____5¶¶¶¶¶¶¶5_¶¶¶¶¶5_¶__¶¶_5¶¶ ";
sleep 0.1;
echo "_¶¶__5¶¶¶¶¶¶¶¶¶¶5____5¶¶¶¶¶¶_¶¶¶¶¶_____¶5_¶¶ ";
sleep 0.1;
echo "_¶¶___5¶¶¶¶¶¶¶¶¶__________5¶5_¶¶¶¶¶____¶¶_¶¶ ";
sleep 0.1;
echo "_¶¶_______5¶¶¶¶¶¶5____________¶¶¶¶¶_____¶_¶¶ ";
sleep 0.1;
echo "_5¶5________5¶¶_¶¶¶¶5________5¶¶¶¶¶_______¶¶ ";
sleep 0.1;
echo "__¶¶__________¶___¶¶¶¶¶5___5¶¶¶¶¶¶5_______¶5 ";
sleep 0.1;
echo "__¶¶____________5¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶________¶ ";
sleep 0.1;
echo "___¶________________5¶¶¶¶¶¶¶¶5_¶¶ ";
sleep 0.1;
echo "___¶__________5¶¶¶¶¶¶¶¶5¶¶¶5__5¶5 ";
sleep 0.1;
echo -e "_____________________5¶¶¶5____¶5 \e[37m ";
sleep 0.1;
                                                  
                                                  

case $2 in
-all|-ALL)cd /root; go install github.com/hahwul/dalfox/v2@latest; mv /root/go/bin/dalfox /bin;
cd /root; git clone https://github.com/jakeelong/sniper; cd sniper && bash install.sh && sniper -u; cd /root;
git clone https://github.com/xmendez/wfuzz;
 ;;
*) echo "INSTALL OFF";;
esac

#question
serv="";
read -p "the site run http(1) or https(2)?:" serv;
if  [ "$serv" == "1" ]; then
serv="http";
elif [ "$serv" == "2" ]; then
serv="https";
else
echo "ERROR : Please enter correct number."; exit
fi





cd /root;
mkdir vulnez;
cd vulnez;
#wpscan 
clear;
wp="";
read -p "want to run wpscan?(yes/y/no)" wp;
if ["$wp" == "yes" ] || [ "$wp" == "y" ]; then
wpscan $serv://$1 | tee wpscan.txt;
elif  [ "$wp" == "n" || "$wp" == "no" ]; then
sleep 1;
echo "NEXT STEP";
fi


#sniper
sniper -u; 
sniper -t $1 -m webscan | tee snipersimples.txt;
resp="";
clear;
read -p "do yoy want to run full scan in all subdomains(yes/y/n)? timeout(2h min!)";
if ["$resp" == "y" ] || ["$resp" == "yes"];then
subfinder -d $1 | tee subss.txt;
sniper -f subss.txt -m airstrike -w $1 | tee sniperFull.txt;
rm subss.txt;
elif  ["$resp" == "n"] || ["$resp" == "no"] ; then
subfinder -d $1 | tee subss.txt;
head -n 5 subss.txt | tee top5.txt;
sniper -f top5.txt -m airstrike -w $1 | tee snipertop5.txt;
rm subss.txt;
else
echo "<ERROR>";
fi

#nikto
nikto -h $serv://$1 -Tuning 123 -Plugins 1234 -output nikto.txt;
#dalfox 
subfinder -update;
subfinder -d $1 | tee subs.txt;
cat subs.txt | gau | tee subsgau.txt;
rm subs.txt;
cat subsgau.txt | gf xss | tee xss.txt;
dalfox file xss.txt | tee dalfox.txt;
#nuclei
nuclei -list subsgau.txt | tee nuclei.txt;


#vulnx
git clone https://github.com/anouarbensaad/VulnX.git;
cd VulnX;
chmod +x install.sh && bash install.sh;
vulnx -u $serv://$1 -w -d --dns -e --output vulnx.txt;
mv vulnx.txt /root/vulnez/;



#paramspider e iniciando processo de fuzzing
cd /root/vulnez;
mkdir fuzzing;
git clone https://github.com/0xKayala/ParamSpider;
cd  ParamSpider;
pip3 install -r requirements.txt;
chmod +x paramspider.py;
python3 paramspider.py --domain $1 --output fuzzINIT.txt;
cp output;
mv fuzzINIT.txt /root/vulnez/fuzzing/;
cd  /root/vulnez/fuzzing;


#criação das pastas e fuzzing de cada tipo
mkdir xss redirect lfi idor;
cat fuzzINIT.txt | gf xss | tee xss.txt;
mv xss.txt xss;
cat fuzzINIT.txt | gf redirect | tee redirect.txt;
mv redirect.txt redirect;
cat  fuzzINIT.txt | gf idor | tee idor.txt;
mv  idor.txt idor;
cat fuzzINIT.txt | gf lfi | tee lfi.txt;
mv lfi.txt lfi;
cd xss;


#fuzzing de XSS das tres primeiras linhas
wget https://raw.githubusercontent.com/danielmiessler/SecLists/master/Fuzzing/XSS-Fuzzing;
xss1=$(tail -n +1 xss.txt | head -n 1);
wfuzz --hc 404,400,406 -c -z file,XSS-Fuzzing $xss1 | tee xssL1F.txt;
xss2=$(tail -n +2 xss.txt | head -n 1);
wfuzz --hc 404,400,406 -c -z file,XSS-Fuzzing $xss2 | tee xssL2F.txt;
xss3=$(tail -n +3 xss.txt | head -n 1);
wfuzz --hc 404,400,406 -c -z file,XSS-Fuzzing $xss3 | tee xssL3F.txt;
cd ..;
#fuzzing de redirect das tres primeiras linhas
cd redirect;
wget https://raw.githubusercontent.com/yamotoz/Angel_Azazel/main/payload_redirect.txt;
redi1=$(tail -n +1 redirect.txt | head -n 1);
wfuzz --hc 404,400,406 -c -z file,payload_redirect.txt $redi1 | tee rediL1F.txt;
redi2=$(tail -n +2 redirect.txt | head -n 1);
wfuzz --hc 404,400,406 -c -z file,payload_redirect.txt $redi2 | tee rediL2F.txt;
redi3=$(tail -n +3 redirect.txt | head -n 1);
wfuzz --hc 404,400,406 -c -z file,payload_redirect.txt $redi3 | tee rediL3F.txt;
cd ..;
#LFI fuzzing
cd lfi;
wget https://github.com/danielmiessler/SecLists/blob/master/Fuzzing/LFI/LFI-linux-and-windows_by-1N3%40CrowdShield.txt;
lfi1=$(tail -n +1 lfi.txt | head -n 1);
wfuzz --hc 404,400,406 -c -z file,LFI-linux-and-windows_by-1N3%40CrowdShield.txt $lfi1 | tee lfiL1F.txt;
lfi2=$(tail -n +2 lfi.txt | head -n 1);
wfuzz --hc 404,400,406 -c -z file,LFI-linux-and-windows_by-1N3%40CrowdShield.txt $lfi2 | tee lfiL2F.txt;
lfi3=$(tail -n +3 lfi.txt | head -n 1);
wfuzz --hc 404,400,406 -c -z file,LFI-linux-and-windows_by-1N3%40CrowdShield.txt $lfi3 | tee lfiL3F.txt;
cd ..;
# Idor Fuzzing
cd idor;
crunch 1 5 -f /usr/share/crunch/charset.lst numeric -o idorP.txt;
idor1=$(tail -n +1 lfi.txt | head -n 1);
wfuzz --hc 404,400,406 -c -z file,idorP.txt $idor1 | tee idorL1F.txt;
idor2=$(tail -n +2 lfi.txt | head -n 1);
wfuzz --hc 404,400,406 -c -z file,idorP.txt $idor2 | tee idorL2F.txt;
idor3=$(tail -n +3 lfi.txt | head -n 1);
wfuzz --hc 404,400,406 -c -z file,idorP.txt $idor3 | tee idorL3F.txt;


# wapiti3
clear;
cd /root/vulnez;
pip3 install wapiti;
wapiti --level 1 -u $serv://$1 -m all --color -v 1 --scan-force insane -f html -o wapiti.html; 

#rapidscan
clear;
var="";
read -p "want to run rapidscan?(yes/y/no): timeout(1h min)" var;
if ["$var" == "yes" ] || [ "$var" == "y" ]; then
python -m pip install;
rapidscan.py --update;
rapidscan.py $1 | tee rapidscan.txt;
else    
sleep 1;
clear;
echo "     |    |     "; 
echo "     |    |     "; 
echo "     |____|     "; 
echo "     |    |     "; 
echo "     (    )     "; 
echo "     )    (     "; 
echo "   .'      `.   "; 
echo "  /          \  "; 
echo " |------------| "; 
echo " |JACK DANIELS| "; 
echo " |    ----    | "; 
echo " |   (No.7)   | "; 
echo " |    ----    | "; 
echo " | Tennessee  | "; 
echo " |  WHISKEY   | "; 
echo " |  40% Vol.  | "; 
echo " |------------| "; 
echo " |____________| "; 
echo ".";
sleep 0.1;
echo ".";
sleep 0.1;
echo ".";
sleep 0.1;
echo ".";
sleep 0.1;
apt-get autoremove; apt-get autoclean;
echo " [>]SCRIPT FINISH[<]";
fi
